{% extends "base.html" %}

{% block title %}Add Course - Golf Score Tracker{% endblock %}

{% block content %}
<div class="add-course-page">
    <h1>Add New Golf Course</h1>

    <!-- SECURITY GAP: No CSRF protection -->
    <form method="POST" action="{{ url_for('add_course') }}" id="courseForm">
        <div class="form-section">
            <h3>Course Information</h3>

            <div class="form-group">
                <label for="name">Course Name *</label>
                <input type="text" id="name" name="name" required>
            </div>

            <div class="form-group">
                <label for="location">Location</label>
                <input type="text" id="location" name="location" placeholder="City, State">
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label for="num_holes">Number of Holes *</label>
                    <select id="num_holes" name="num_holes" onchange="generateHoles()">
                        <option value="9">9 holes</option>
                        <option value="18" selected>18 holes</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="par">Total Par *</label>
                    <input type="number" id="par" name="par" value="72" required>
                </div>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label for="course_rating">Course Rating *</label>
                    <input type="number" step="0.1" id="course_rating" name="course_rating" value="72.0" required>
                </div>

                <div class="form-group">
                    <label for="slope_rating">Slope Rating *</label>
                    <input type="number" id="slope_rating" name="slope_rating" value="130" min="55" max="155" required>
                </div>
            </div>
        </div>

        <div class="form-section">
            <h3>Hole Details</h3>
            <p class="subtitle">Enter par, handicap, and yardage for each hole</p>

            <div id="holesContainer">
                <!-- Holes will be generated by JavaScript -->
            </div>
        </div>

        <div class="form-actions">
            <button type="submit" class="btn btn-primary">Add Course</button>
            <a href="{{ url_for('courses') }}" class="btn btn-secondary">Cancel</a>
        </div>
    </form>
</div>

<script>
function generateHoles() {
    const numHoles = parseInt(document.getElementById('num_holes').value);
    const container = document.getElementById('holesContainer');
    container.innerHTML = '';

    for (let i = 1; i <= numHoles; i++) {
        const holeDiv = document.createElement('div');
        holeDiv.className = 'hole-input-row';
        holeDiv.innerHTML = `
            <div class="hole-number">Hole ${i}</div>
            <div class="hole-inputs">
                <input type="number" name="hole_${i}_par" placeholder="Par" value="4" min="3" max="5" required>
                <input type="number" name="hole_${i}_handicap" placeholder="Handicap" value="${i}" min="1" max="${numHoles}" required>
                <input type="number" name="hole_${i}_yardage" placeholder="Yardage" value="400" min="100" max="700" required>
            </div>
        `;
        container.appendChild(holeDiv);
    }
}

// Generate default 18 holes on page load
document.addEventListener('DOMContentLoaded', generateHoles);
</script>
{% endblock %}
